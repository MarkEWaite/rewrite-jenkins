---
type: specs.openrewrite.org/v1beta/recipe
name: net.sghill.jenkins.rewrite.UpgradeHtmlUnit_3_3_0
recipeList:
  - org.openrewrite.java.ChangePackage:
      oldPackageName: com.gargoylesoftware.htmlunit
      newPackageName: org.htmlunit
      recursive: true
  - org.openrewrite.java.OrderImports:
      removeUnused: false
  - org.openrewrite.java.ChangeMethodName:
      methodPattern: org.htmlunit.html.HtmlInput getValueAttribute()
      newMethodName: getValue
      ignoreDefinition: true
      matchOverrides: true
  - org.openrewrite.java.ChangeMethodName:
      methodPattern: org.htmlunit.html.HtmlInput setValueAttribute(String)
      newMethodName: setValue
      ignoreDefinition: true
      matchOverrides: true
# TODO match if the first attribute is a literal
#  - org.openrewrite.java.ChangeMethodName:
#      methodPattern: org.htmlunit.html.HtmlInput setAttribute("value", String)
#      newMethodName: setValue
#      ignoreDefinition: true
#      matchOverrides: true
---
type: specs.openrewrite.org/v1beta/recipe
name: net.sghill.jenkins.rewrite.UpgradeParentPom_4_66
displayName: Migrate to Parent POM 4.66
description: Upgrade to Parent POM 4.66
recipeList:
  - net.sghill.jenkins.rewrite.UpgradeParentPom_4_40
  - org.openrewrite.maven.ChangeParentPom:
      oldGroupId: org.jenkins-ci.plugins
      oldArtifactId: plugin
      newVersion: 4.66
      allowVersionDowngrades: false
  - net.sghill.jenkins.rewrite.UpgradeHtmlUnit_3_3_0
---
type: specs.openrewrite.org/v1beta/recipe
name: net.sghill.jenkins.rewrite.UpgradeParentPom_4_52
displayName: Migrate to Parent POM 4.52
description: Upgrade to Parent POM 4.52 (requires Java 11)
recipeList:
  - org.openrewrite.maven.ChangeParentPom:
      oldGroupId: org.jenkins-ci.plugins
      oldArtifactId: plugin
      newVersion: 4.52
      allowVersionDowngrades: false
  - org.openrewrite.maven.ChangePropertyValue:
      key: jenkins.version
      newValue: 2.361.4
      addIfMissing: false
  - org.openrewrite.maven.ChangeManagedDependencyGroupIdAndArtifactId:
      oldGroupId: io.jenkins.tools.bom
      oldArtifactId: bom-2.303.x
      newGroupId: io.jenkins.tools.bom
      newArtifactId: bom-2.361.x
      newVersion: 2102.v854b_fec19c92
  - net.sghill.jenkins.rewrite.UpgradeParentPom_4_50
---
type: specs.openrewrite.org/v1beta/recipe
name: net.sghill.jenkins.rewrite.UpgradeParentPom_4_50
displayName: Migrate to Parent POM 4.50
description: Upgrade to Parent POM 4.50
recipeList:
  - org.openrewrite.maven.ChangeParentPom:
      oldGroupId: org.jenkins-ci.plugins
      oldArtifactId: plugin
      newVersion: 4.50
      allowVersionDowngrades: false
  - net.sghill.jenkins.rewrite.UpgradeParentPom_4_49
# TODO: min jenkins 2.326 if jcip annotations used
---
type: specs.openrewrite.org/v1beta/recipe
name: net.sghill.jenkins.rewrite.UpgradeParentPom_4_49
displayName: Migrate to Parent POM 4.49
description: Upgrade to Parent POM 4.49
recipeList:
  - org.openrewrite.maven.ChangeParentPom:
      oldGroupId: org.jenkins-ci.plugins
      oldArtifactId: plugin
      newVersion: 4.49
      allowVersionDowngrades: false
  - net.sghill.jenkins.rewrite.UpgradeParentPom_4_46
# TODO: run build and check for you-must-override-the-yarn.version-property to know if properties must be added
---
type: specs.openrewrite.org/v1beta/recipe
name: net.sghill.jenkins.rewrite.UpgradeParentPom_4_46
displayName: Migrate to Parent POM 4.46
description: Upgrade to Parent POM 4.46
recipeList:
  - org.openrewrite.maven.ChangeParentPom:
      oldGroupId: org.jenkins-ci.plugins
      oldArtifactId: plugin
      newVersion: 4.46
      allowVersionDowngrades: false
  - org.openrewrite.maven.RemoveRedundantDependencyVersions:
      groupPattern: junit
      artifactPattern: junit
      onlyIfVersionsMatch: false
  - net.sghill.jenkins.rewrite.UpgradeParentPom_4_43_1
---
type: specs.openrewrite.org/v1beta/recipe
name: net.sghill.jenkins.rewrite.UpgradeParentPom_4_43_1
displayName: Migrate to Parent POM 4.43.1
description: Upgrade to Parent POM 4.43.1
recipeList:
  - org.openrewrite.maven.ChangeParentPom:
      oldGroupId: org.jenkins-ci.plugins
      oldArtifactId: plugin
      newVersion: 4.43.1
      allowVersionDowngrades: false
  - net.sghill.jenkins.rewrite.UpgradeParentPom_4_40
# TODO: jenkins.version 2.249.1 w/o downgrades
---
type: specs.openrewrite.org/v1beta/recipe
name: net.sghill.jenkins.rewrite.UpgradeParentPom_4_40
displayName: Migrate to Parent POM 4.40
description: Upgrade to Parent POM 4.40
recipeList:
  - org.openrewrite.maven.ChangeParentPom:
      oldGroupId: org.jenkins-ci.plugins
      oldArtifactId: plugin
      newVersion: 4.40
      allowVersionDowngrades: false
  - org.openrewrite.maven.RemoveProperty:
      propertyName: java.level
  - org.openrewrite.text.FindAndReplace:
      find: buildPlugin()
      replace: >
        buildPlugin(useContainerAgent: true, configurations: [
          [ platform: 'linux', jdk: '11' ],
          [ platform: 'windows', jdk: '11' ],
          [ platform: 'linux', jdk: '17' ],
        ])
---
type: specs.openrewrite.org/v1beta/recipe
name: net.sghill.jenkins.RemoveDep
recipeList:
  - org.openrewrite.maven.RemoveDependency:
      groupId: org.jenkins-ci
      artifactId: annotation-indexer
  - org.openrewrite.maven.RemoveDependency:
      groupId: org.jenkins-ci
      artifactId: symbol-annotation
---
type: specs.openrewrite.org/v1beta/recipe
name: net.sghill.jenkins.rewrite.CommonsLang3ToApiPlugin
recipeList:
  - net.sghill.jenkins.rewrite.ReplaceLibrariesWithApiPlugin:
      pluginGroupId: io.jenkins.plugins
      pluginArtifactId: commons-lang3-api
      pluginVersion: 3.12.0.0
      replaces:
        - groupId: org.apache.commons
          artifactId: commons-lang3
---
type: specs.openrewrite.org/v1beta/recipe
name: net.sghill.jenkins.ModernizePlugin
recipeList:
  - net.sghill.jenkins.rewrite.ChangeJenkinsVersion:
      parentPomVersion: "4.64"
      jenkinsVersion: "2.332.1"
  - net.sghill.jenkins.rewrite.AddPluginsBom:
      bomName: bom-2.332.x
      bomVersion: "1763.v092b_8980a_f5e"
  - net.sghill.jenkins.rewrite.DisableLocalResolutionForParentPom
  - org.openrewrite.maven.RemoveProperty:
      # as of parent pom 4.40 this is deprecated and unused
      propertyName: java.level
  - net.sghill.jenkins.RemoveDep
  - org.openrewrite.maven.security.UseHttpsForRepositories
---
type: specs.openrewrite.org/v1beta/recipe
name: net.sghill.jenkins.rewrite.JavaxAnnotationsToSpotbugs
recipeList:
  - org.openrewrite.java.ChangeType:
      oldFullyQualifiedTypeName: javax.annotation.Nonnull
      newFullyQualifiedTypeName: edu.umd.cs.findbugs.annotations.NonNull
      ignoreDefinition: true
  - org.openrewrite.java.ChangePackage:
      oldPackageName: javax.annotation
      newPackageName: edu.umd.cs.findbugs.annotations
      recursive: false
  - org.openrewrite.java.OrderImports:
      removeUnused: false
